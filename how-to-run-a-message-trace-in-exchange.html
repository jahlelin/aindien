<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>How To Run A Message Trace In Exchange - Jason Moore&#x27;s Computing Guides</title><meta name="description" content="A message trace is a feature in the Exchange admin center and you can use it to find out what happened to an email."><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://aindien.com/how-to-run-a-message-trace-in-exchange.html"><link rel="alternate" type="application/atom+xml" href="https://aindien.com/feed.xml"><link rel="alternate" type="application/json" href="https://aindien.com/feed.json"><style>:root{--body-font:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";--heading-font:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";--logo-font:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";--menu-font:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol"}</style><link rel="stylesheet" href="https://aindien.com/assets/css/style.css?v=e0d2512160dcefa5eef886706cef7856"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://aindien.com/how-to-run-a-message-trace-in-exchange.html"},"headline":"How To Run A Message Trace In Exchange","datePublished":"2022-05-18T22:45","dateModified":"2022-08-26T13:57","description":"A message trace is a feature in the Exchange admin center and you can use it to find out what happened to an email.","author":{"@type":"Person","name":"Jason Moore"},"publisher":{"@type":"Organization","name":"Jason Moore"}}</script><script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.6.1/MathJax.js?config=TeX-MML-AM_CHTML"></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-393JFJ482L"></script><script>window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-393JFJ482L');</script><script id="mcjs">!function(c,h,i,m,p){m=c.createElement(h),p=c.getElementsByTagName(h)[0],m.async=1,m.src=i,p.parentNode.insertBefore(m,p)}(document,"script","https://chimpstatic.com/mcjs-connected/js/users/5aefa50c3a5900492b165a83f/93dcd5a76da18d3becc7e677f.js");</script></head><body><div class="site-container"><header class="top" id="js-header"><a class="logo" href="https://aindien.com/">Jason Moore&#x27;s Computing Guides</a><nav class="navbar js-navbar"><button class="navbar__toggle js-toggle" aria-label="Menu" aria-haspopup="true" aria-expanded="false"><span class="navbar__toggle-box"><span class="navbar__toggle-inner">Menu</span></span></button><ul class="navbar__menu"><li><a href="https://mailchi.mp/70ab982b2619/computing" target="_self">Home</a></li><li><a href="https://aindien.com/c-essentials.html" target="_self">C++ Essentials</a></li><li><a href="https://aindien.com/networking-essentials.html" target="_self">Networking Essentials</a></li><li><a href="https://aindien.com/economics-essentials.html" target="_self">Economics Essentials</a></li><li><a href="https://aindien.com/office365-essentials.html" target="_self">Office365 Tips and Fixes</a></li><li><a href="https://aindien.com/linux-essentials-.html" target="_self">Linux Essentials</a></li><li><a href="https://aindien.com/r-essentials.html" target="_self">Introduction to R Programming</a></li></ul></nav><div class="search"><div class="search__overlay js-search-overlay"><div class="search__overlay-inner"><form action="https://aindien.com/search.html" class="search__form"><input class="search__input js-search-input" type="search" name="q" placeholder="search..." aria-label="search..." autofocus="autofocus"></form><button class="search__close js-search-close" aria-label="Close">Close</button></div></div><button class="search__btn js-search-btn" aria-label="Search"><svg role="presentation" focusable="false"><use xlink:href="https://aindien.com/assets/svg/svg-map.svg#search"/></svg></button></div></header><main><article class="post"><div class="hero"><figure class="hero__image hero__image--overlay"><img src="https://aindien.com/media/website/computing-logo-2.jpg" srcset="https://aindien.com/media/website/responsive/computing-logo-2-xs.jpg 300w, https://aindien.com/media/website/responsive/computing-logo-2-sm.jpg 480w, https://aindien.com/media/website/responsive/computing-logo-2-md.jpg 768w, https://aindien.com/media/website/responsive/computing-logo-2-lg.jpg 1024w, https://aindien.com/media/website/responsive/computing-logo-2-xl.jpg 1360w, https://aindien.com/media/website/responsive/computing-logo-2-2xl.jpg 1600w" sizes="(max-width: 1600px) 100vw, 1600px" loading="eager" alt=""></figure><header class="hero__content"><div class="wrapper"><div class="post__meta"><time datetime="2022-05-18T22:45">May 18, 2022</time></div><h1>How To Run A Message Trace In Exchange</h1><div class="post__meta post__meta--author"><a href="https://aindien.com/authors/jason-moore/" class="feed__author invert">Jason Moore</a></div></div></header></div><div class="wrapper post__entry"><p data-pm-slice="0 0 []">A message trace is a feature in the Exchange admin center and you can use it to find out what happened to an email.</p><div class="post__iframe"><iframe loading="lazy" width="720" height="300" style="border: none;" src="//rcm-na.amazon-adsystem.com/e/cm?o=1&amp;p=50&amp;l=ur1&amp;category=grocery&amp;banner=06G5XQ8VKMF8KR9MCYR2&amp;f=ifr&amp;linkID=bc18e51f5bf3afba50372a040e016178&amp;t=aindien-20&amp;tracking_id=aindien-20" scrolling="no" border="0" marginwidth="0" frameborder="0" sandbox="allow-scripts allow-same-origin allow-popups allow-top-navigation-by-user-activation"></iframe></div><h3><span style="color: #236fa1;"><strong>Introduction</strong></span></h3><p>You will need a certain set of permissions in order to access and use the Exchange admin center. Your organization will provide you with the proper credentials.</p><h3><span style="color: #236fa1;"><strong>Why Run a Message Trace</strong></span></h3><p>One of the main reasons to run a message trace is a user will report they did not receive a message they were expecting. This is an instance where you can check whether it delivered a particular message to a certain mailbox. You can also see if it was quarantined or rejected outright.</p><p>Another reason you would want to do a message trace is that users sometimes forget and delete their messages. You can show them that their email is just in a deleted folder.</p><h3><span style="color: #236fa1;"><strong>How To Run A Message Trace</strong></span></h3><p>Here are the basic steps to perform a message trace:</p><ul><li><p>Open the admin center</p></li><li><p><a href="https://admin.exchange.microsoft.com/" target="_blank" rel="noopener">https://admin.exchange.microsoft.com/</a></p></li><li><p>Select Mail Flow from the left menu</p></li><li><p>Select message trace under the Mail Flow category</p></li><li><p>In the middle of the screen, select &lt;Start a trace&gt;</p></li><li><p>In the &lt;Senders&gt; box, input the email address you want to check</p></li><li><p>In the &lt;Recipients&gt; box, input the email address you want.</p></li><li><p>Under &lt;Time range&gt;, select anything from 0 to 10 days for immediate response.</p></li><li><p>If longer than 10 days is needed, it will take longer because it prepares a downloadable report</p></li><li><p>There are other options you can play with, but when done, select &lt;Search&gt;</p></li></ul><p>Message tracing gives you a lot of flexibility. You can do a lot with it too. I used it yesterday to see if emails were being sent from one user to another. There are many other scenarios you can check for as needed.</p><h3><span style="color: #236fa1;"><strong>A Few Details To Note</strong></span></h3><p>Another thing I should mention is that you can leave all the fields blank in the message trace section except for either &lt;Sender&gt; or &lt;Recipient&gt;. When done this way, it will default to the last 48 hours of emails sent from or received by a certain address. You can also put in a certain sender or recipient and leave the rest blank and it will still default to the last 48 hours.</p><p>When doing custom searches, pay attention to the time zone. This field often goes unnoticed and introduces confusion. So, if you wondered why you emailed someone at 3 am while you were asleep, it is probably the time zone setting.</p><p>In the &lt;Delivery status&gt; section, there is a drop down menu there that can further refine your search. This is very helpful when you need to narrow down your list to go over.</p><p>When you need to look at a certain email, the message will have a unique ID that you can use to get more details about that message.</p><p>You can also add multiple recipients or senders to any trace. This is helpful if you want to find out more information.</p><h3><span style="color: #236fa1;"><strong>Interpreting The Results</strong></span></h3><p>After the trace results come back, it will list them in the most recent order. There are several fields there and we can click them to sort under that header. Clicking the same header again will reverse the sort.</p><p>For any message, you can double click it to get additional details. The unique message ID is located here. IP information is also located here, which is useful.</p><h3><span style="color: #236fa1;"><strong>How Long Does It Take</strong></span></h3><p>If your time interval is under 10 days, the results appear immediately. However, if the time interval is longer, then you will get a downloadable csv file sent to your email in a few hours. So, take that in mind whenever you need to do a trace.</p><h3><span style="color: #236fa1;"><strong>Message Tracing With PowerShell</strong></span></h3><p>This is another way to do message tracing. You can do whichever method is more comfortable for you. The first thing you need to do is import the Exchange module. I do it like this:</p><pre>Import-Module ExchangeOnlineManagement</pre><p>Now you need to connect to the module within your PowerShell session.</p><pre>Connect-ExchangeOnline -UserPrincipalName &lt;user&gt;</pre><p>Now you can perform message tracing. The format of the command is:</p><pre>Get-MessageTrace -SenderAddress &lt;email&gt; -StartDate 05/08/2022 -EndDate 05/18/2022</pre><p>The &lt;SenderAddress&gt; is where the mail is coming from. The date ranges must be within 10 days or the command will fail.</p><p>Many times you will want to get the &lt;MessageID&gt; of emails so you can investigate a particular email. You do that like this:</p><pre>Get-MessageTrace -RecipientAddress &lt;email&gt; -StartDate 05/05/2022 -EndDate 05/10/2022 | Format-list -Property Received,SenderAddress,Status,MessageTraceId</pre><p>This will return a list of emails with their ID. You can copy this ID into the next command. It will give you details of a particular message.</p><pre><code>Get-MessageTraceDetail -MessageTraceId ae5c1219-4c90-41bf-fef5-08d837917e7c -RecipientAddress &lt;email&gt;</code></pre><p>The &lt;MessageTraceID&gt; is a unique value that is got from the previous command.</p><p>Finally, we can do a historical search. This is useful when you need a longer period of messages.</p><pre><code>Start-HistoricalSearch -ReportTitle ExtendedMessageTrace -StartDate 5/11/2022 -EndDate 5/18/2022 -ReportType MessageTraceDetail -NotifyAddress jasonmoore@magnolia.com -SenderAddress itsupport@magnolia.com -RecipientAddress jasonmoore@<a href="magnolia.com" target="_blank" rel="noopener">magnolia.com</a></code></pre><p>You will get a job ID when it is successful.</p><h3><span style="color: #236fa1;"><strong>Conclusion</strong></span></h3><p>This document was about performing a message trace in the Exchange admin center. We talked about why do this and also how it is done. Then we discussed some details about messages and the resulting reports.</p><p>Then we talked about how to do these tasks in PowerShell. That is useful because they can scripted and automated, which is what we should all be striving to do.</p><p> </p><p> </p><p> </p></div><footer class="wrapper post__footer"><p class="post__last-updated">This article was updated on August 26, 2022</p><ul class="post__tag"><li><a href="https://aindien.com/powershell/">Powershell</a></li></ul><div class="post__share"><a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Faindien.com%2Fhow-to-run-a-message-trace-in-exchange.html" class="js-share facebook" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://aindien.com/assets/svg/svg-map.svg#facebook"/></svg> <span>Facebook</span> </a><a href="https://twitter.com/share?url=https%3A%2F%2Faindien.com%2Fhow-to-run-a-message-trace-in-exchange.html&amp;via=_Aindien&amp;text=How%20To%20Run%20A%20Message%20Trace%20In%20Exchange" class="js-share twitter" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://aindien.com/assets/svg/svg-map.svg#twitter"/></svg> <span>Twitter</span></a></div><div class="post__bio bio"><div class="bio__info"><h3 class="bio__name"><a href="https://aindien.com/authors/jason-moore/" class="invert" rel="author">Jason Moore</a></h3></div></div></footer></article><nav class="post__nav"><div class="post__nav-inner"><div class="post__nav-prev"><svg width="1.041em" height="0.416em" aria-hidden="true"><use xlink:href="https://aindien.com/assets/svg/svg-map.svg#arrow-prev"/></svg> <a href="https://aindien.com/how-to-fix-windows-needs-your-current-credentials.html" class="invert post__nav-link" rel="prev"><span>Previous</span> How To Fix &quot;Windows Needs Your Current Credentials&quot;</a></div><div class="post__nav-next"><a href="https://aindien.com/how-to-change-uac-behavior-in-windows.html" class="invert post__nav-link" rel="next"><span>Next</span> How To Change UAC Behavior In Windows </a><svg width="1.041em" height="0.416em" aria-hidden="true"><use xlink:href="https://aindien.com/assets/svg/svg-map.svg#arrow-next"/></svg></div></div></nav><div class="post__related related"><div class="wrapper"><h2 class="h5 related__title">You should also read:</h2><article class="related__item"><div class="feed__meta"><time datetime="2022-07-12T23:26" class="feed__date">July 12, 2022</time></div><h3 class="h1"><a href="https://aindien.com/network-troubleshooting-with-traceroute.html" class="invert">Network Troubleshooting With Traceroute</a></h3></article></div></div><div class="banner banner--after-post"><div class="wrapper"><link href="//cdn-images.mailchimp.com/embedcode/classic-10_7.css" rel="stylesheet" type="text/css"><style type="text/css">#mc_embed_signup{background:#fff; clear:left; font:14px Helvetica,Arial,sans-serif; }
	/* Add your own Mailchimp form style overrides in your site stylesheet or in this style block.
	   We recommend moving this block and the preceding CSS link to the HEAD of your HTML file. */</style><div id="mc_embed_signup"><form action="https://aindien.us11.list-manage.com/subscribe/post?u=5aefa50c3a5900492b165a83f&amp;id=1c348b805a" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate><div id="mc_embed_signup_scroll"><h2>Subscribe</h2><div class="indicates-required"><span class="asterisk">*</span> indicates required</div><div class="mc-field-group"><label for="mce-EMAIL">Email Address <span class="asterisk">*</span></label> <input type="email" name="EMAIL" class="required email" id="mce-EMAIL"></div><div class="mc-field-group"><label for="mce-FNAME">First Name</label> <input type="text" name="FNAME" id="mce-FNAME"></div><div class="mc-field-group"><label for="mce-LNAME">Last Name</label> <input type="text" name="LNAME" id="mce-LNAME"></div><div id="mce-responses" class="clear"><div class="response" id="mce-error-response" style="display:none"></div><div class="response" id="mce-success-response" style="display:none"></div></div><div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_5aefa50c3a5900492b165a83f_1c348b805a" tabindex="-1"></div><div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button"></div></div></form></div><script type="text/javascript" src="//s3.amazonaws.com/downloads.mailchimp.com/js/mc-validate.js"></script><script type="text/javascript">(function($) {window.fnames = new Array(); window.ftypes = new Array();fnames[0]='EMAIL';ftypes[0]='email';fnames[1]='FNAME';ftypes[1]='text';fnames[2]='LNAME';ftypes[2]='text';}(jQuery));var $mcj = jQuery.noConflict(true);</script></div></div></main><footer class="footer"><div class="footer__copyright"><p>Jason Moore 2022</p></div><button class="footer__bttop js-footer__bttop" aria-label="Back to top"><svg><title>Back to top</title><use xlink:href="https://aindien.com/assets/svg/svg-map.svg#toparrow"/></svg></button></footer></div><script>window.publiiThemeMenuConfig = {    
        mobileMenuMode: 'sidebar',
        animationSpeed: 300,
        submenuWidth: 'auto',
        doubleClickTime: 500,
        mobileMenuExpandableSubmenus: true, 
        relatedContainerForOverlayMenuSelector: '.top',
   };</script><script defer="defer" src="https://aindien.com/assets/js/scripts.min.js?v=f4c4d35432d0e17d212f2fae4e0f8247"></script><script>var images = document.querySelectorAll('img[loading]');

        for (var i = 0; i < images.length; i++) {
            if (images[i].complete) {
                images[i].classList.add('is-loaded');
            } else {
                images[i].addEventListener('load', function () {
                    this.classList.add('is-loaded');
                }, false);
            }
        }</script></body></html>